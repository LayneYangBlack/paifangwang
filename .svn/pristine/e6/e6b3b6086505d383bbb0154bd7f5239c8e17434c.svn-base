<!doctype html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="initial-scale=1.0,maximum-scale=1.0,minimum-scale=1.0,user-scalable=0, width=device-width"/>
    <meta name="format-detection" content="telephone=no,email=no,date=no,address=no">
    <title>拍房网</title>
    <link rel="stylesheet" type="text/css" href="./css/api.css"/>
    <link rel="stylesheet" type="text/css" href="./css/chat.css"/>
    <link rel="stylesheet" type="text/css" href="./css/commonWindow.css" />
    <style>
        html, body {
            height: 100%
        }
        body {
            background-color: #F4F5F5;
            font-size: 14px;
        }
        /**页面高度**/
        #wrap {
            height: 100%;
            display: -webkit-box;
            display: -webkit-flex;
            display: flex;
            -webkit-box-orient: vertical;
            -webkit-flex-flow: column;
            flex-flow: column;
        }

        /**页面高度铺满**/
        #main {
            -webkit-box-flex: 1;
            -webkit-flex: 1;
            flex: 1;
        }

        /**========头部标签（开始）=====**/
        #header{
            width: 100%;
            height:48px;
            background-color: #39bc30;
            display: flex;
            justify-content: center;
            align-items: center;
            -webkit-align-items:center;
            color: #FFFFFF;
            font-size: 18px;
        }
        #city_add{
            text-align: center;
            display: block;
            font-size: 16px;
            overflow: hidden;
            float: left;;
            white-space:nowrap;
            text-overflow: ellipsis;
            width: 70%;
        }
        #input{
            background-color: #FFFFFF;
            width: 54%;
            height:24px ;
            border-radius: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .input_search{
            border: none ;
            width: 80% ;
            font-size: 12px ;
            outline: none;
            line-height: 24px;
        }
        .city{
            width: 25%;float: left;position: relative;height: 48px;line-height: 48px;
        }
        #header .header {
            display: none;
            position: relative;
           
        }
        #header .active {
            display:flex;
            align-items: center;
            -webkit-align-items: center;
        }
        /**========头部标签（结束）=====**/

        /**========底部菜单（开始）=====**/
        #nav {
            background-color: rgb(248,248,248);
            /*border-top: 1px solid #DADDE0;*/
            width: 100%;
            text-align: center;
            position: relative;
            font-size: 10px;
            height:50px;
        }

        #nav ul {
            display: -webkit-box;
            display: -webkit-flex;
            display: flex;
            -webkit-box-orient: horizontal;
            -webkit-flex-direction: row;
            flex-direction: row;
        }
        #nav ul li {
            -webkit-box-flex: 1;
            -webkit-flex: 1;
            flex: 1;
        }
        #nav li a {
            -webkit-background-size:23px 23px !important;
            background-size: 23px 23px !important;
            color: #707070;
            display: block;
            padding-top: 34px;
            line-height: 14px;
            font-size: 10px;
        }

        #nav li.active a, #nav a.active {
            color: #08BA06;
        }
        /**========底部菜单（结束）=====**/
   /**========底部菜单各个按钮详细的菜单图片样式（开始）=====**/

        #nav .home {
            background: url("./icon/home-1.png") no-repeat center 10px;
        }

        #nav .home.active, #nav li.active .home {
            background: url("./icon/home.png") no-repeat center 10px;
        }

        #nav .auction {
            background: url(./icon/paimai-1.png) no-repeat center 10px;
        }

        #nav .auction.active, #nav li.active .auction {
            background: url(./icon/paimai.png) no-repeat center 10px;
        }
        #nav .live {
            background: url(./icon/live.png) no-repeat center 10px;
        }

        #nav .live.active, #nav li.active .live {
            background: url(./icon/live-1.png) no-repeat center 10px;
        }
        #nav .msg {
            background: url(./icon/msg-1.png) no-repeat center 10px;
        }

        #nav .msg.active, #nav li.active .msg {
            background: url(./icon/msg.png) no-repeat center 10px;
        }
        #nav .user {
            background: url(./icon/user-1.png) no-repeat center 10px;
        }

        #nav .user.active, #nav li.active .user {
            background: url(./icon/user.png) no-repeat center 10px;
        }

        /**========底部菜单各个按钮详细的菜单图片样式（借宿）=====**/
        #leftButton img{
            width: 8px;
            height: 14px;
        }
  </style>
</head>
<body>
<div id="wrap">
    <div id="header">
        <div class="home header" style="width: 100%;">
            <div class="city" onclick="">
			<span id="city_add">

			</span>
                <img src="./icon/Fill_243.png" style="  width: 15%;" alt="" />
            </div>
            <div id="input" onclick="">
                <img src="icon/search_icon.png" style="width: 14px;margin-right: 3%;">
                <input type="text" class="input_search" name="" id="" placeholder="请输入楼盘名称/区域等">
            </div>
            <img src="icon/share_icon.png" alt="" style="width: 20px;position: absolute;right: 13%;top:15px;" >
            <img src="icon/ling.png" style="width: 20px;position: absolute;right: 3%;top:15px;" onclick="openMsg()">
        </div>


        <div class="auction header">
            <div>拍卖</div>
        </div>
        <div class="live header">
            <div>直播</div>
        </div>
        <div class="msg header">
            <div>消息中心</div>
        </div>
        <div class="user header">
           <img style="position: absolute; right: -165px; width: 25px;top:-10px;"  src="icon/set.png" alt="" />
        </div>
		
    </div>
    <div id="main">

    </div>
    <div id="nav">
        <ul>
            <li>
            <a class="home" tapmode="active" onclick="openTab('home')">首页</a>
        </li>
            <li>
                <a class="auction" tapmode="active" onclick="openTab('auction')">拍卖</a>
            </li>
            <li>
                <a class="live" tapmode="active" onclick="openTab('live')">直播</a>
            </li>
            <li>
                <a class="msg" tapmode="active" onclick="openTab('msg')">消息</a>
            </li>
            <li>
                <a class="user" tapmode="active" onclick="openTab('user')">我的</a>
            </li>
        </ul>
    </div>
</div>
</body>
<script type="text/javascript" src="./script/api.js"></script>
<script type="text/javascript" src="./script/user.js"></script>
<script type="text/javascript" src="./script/util.js"></script>
<script type="text/javascript" src="./script/kv.js"></script>
<script type="text/javascript" src="./script/apiCloud.js"></script>
<script type="text/javascript" src="./script/public.js"></script>
<script type="text/javascript" src="./script/template-native.js"></script>
<script type="text/javascript" src="./script/data.js"></script>
<script type="text/javascript" src="./script/init.js"></script>
<script>

    var user;
    var tabs;
    var window_width;
    apiready = function () {

    	//定位所在城市
        var map = api.require('bMap');
        map.getLocation({
        accuracy:'100m',
        autoStop:true
        },function(ret,err){
        if(ret){
            var lon = JSON.stringify(ret.lon);
            var lat =JSON.stringify(ret.lat);
            map.getNameFromCoords({
                lon:lon,
                lat:lat
            },function(ret,err){
                if(ret){
                 //   alert(ret.city);
                document.getElementById('city_add').innerHTML = ret.city;
                }

            })
        }else{
            alert(err);
        }
        });
        systemInit();
        //setLocationValue();
        window_width = api.winWidth;
        //配置tab选项卡 各个页面
        tabs= {
            home: {
                isGroup: false,
                frame: {
                    name: 'home',
                    url: './html/index_tab.html',
                    pageParam: {},
                    rect: {
                        x: 0,
                        y: headHeight+4,
                        w: 'auto',
                        h: api.winHeight - headHeight - bottomHeight-4
                    },
                    bounces: false,
                    opaque: false,
                    //bgColor:'#EDEDED',
                    bgColor: '#fff',
                    allowEdit: true,
                    vScrollBarEnabled: true,
                    showProgress: false,
                    hScrollBarEnabled: false,
                    reload: false
                }
            },
            auction: {
                isGroup: false,
                frame: {
                    name: 'auction',
                    url: './html/auction_tab.html',
                    pageParam: {},
                    rect: {
                        x: 0,
                        y: headHeight+4,
                        w: 'auto',
                        h: api.winHeight - headHeight - bottomHeight-4
                    },
                    bounces: false,
                    opaque: false,
                    //bgColor:'#EDEDED',
                    bgColor: '#fff',
                    allowEdit: true,
                    vScrollBarEnabled: true,
                    showProgress: false,
                    hScrollBarEnabled: false,
                    reload: false
                }
            },
           live: {
                isGroup: false,
                frame: {
                    name: 'live',
                    url: './html/live_tab.html',
                    pageParam: {},
                    rect: {
                        x: 0,
                        y: headHeight+4,
                        w: 'auto',
                        h: api.winHeight - headHeight - bottomHeight-4
                    },
                    bounces: false,
                    opaque: false,
                    //bgColor:'#EDEDED',
                    bgColor: '#fff',
                    allowEdit: true,
                    vScrollBarEnabled: true,
                    showProgress: false,
                    hScrollBarEnabled: false,
                    reload: false
                }
            },
            msg: {
                isGroup: false,
                frame: {
                    name: 'msg',
                    url: './html/msg_tab.html',
                    pageParam: {},
                    rect: {
                        x: 0,
                        y: headHeight+4,
                        w: 'auto',
                        h: api.winHeight - headHeight - bottomHeight-4
                    },
                    bounces: false,
                    opaque: false,
                    //bgColor:'#EDEDED',
                    bgColor: '#fff',
                    allowEdit: true,
                    vScrollBarEnabled: true,
                    showProgress: false,
                    hScrollBarEnabled: false,
                    reload: false
                }
            },
              user: {
                  isGroup: false,
                  frame: {
                      name: 'user',
                      url: './html/user_tab.html',
                      pageParam: {},
                      rect:{
                          x: 0,
                          y: headHeight+4,
                          w: 'auto',
                          h: api.winHeight - headHeight - bottomHeight-4
                      },
                      bounces: false,
                      opaque: false,
                      bgColor: '#fff',
                      allowEdit: true,
                      vScrollBarEnabled: true,
                      showProgress: false,
                      hScrollBarEnabled: false,
                      reload: true
                  }
              }
        };
                //systemInit();

        //设置ios的头部信息颜色。
        if(api.systemType == 'ios') {
            api.setStatusBarStyle({
                style: 'light'
                //	style : 'dark'
            });
        }


        //添加安卓退出按钮事件
        api.addEventListener({
            name: 'keyback'
        }, function (ret, err) {
            closeOnKeyBack();
        });
       
//        var userInfo = getUserInfo();
//        if(isNotBlack(userInfo)&&isNotBlack(userInfo.phone)){
//            document.getElementById('right').style.display = "none";
//        }
		openTab('home');
    };

    var backButtonPress = 0;
    function closeOnKeyBack() {
        backButtonPress++;
        if (backButtonPress > 1) {
            closeApp();
        } else {
            api.toast({msg: '再按一次退出应用'});
        }
        setTimeout(function () {
            backButtonPress = 0;
        }, 1000);
    }

    function switchFrameGroupIndex(index){
        api.setFrameGroupIndex({
            name : "homeGroup",
            index : index,
            scroll : true
        });

    }

    function removeRedPoint(){
        document.getElementById('userNoticeDiv').style.display = 'none';
        $api.setStorage('redPint',false)

    }
   
	//选择城市
	function selectCity(){
		var UICityList = api.require('UICityList');
        UICityList.open({
            rect: {
                x: 0,
                y: 0,
                w: api.frameWidth,
                h: api.frameHeight
            },
            resource: 'widget://res/cityList.json',
            styles: {
                searchBar: {
                    bgColor: '#696969',
                    cancelColor: '#E3E3E3'
                },
                location: {
                    color: '#696969',
                    size: 14
                },
                sectionTitle: {
                    bgColor: '#eee',
                    color: '#000',
                    size: 14
                },
                item: {
                    bgColor: '#fff',
                    activeBgColor: '#696969',
                    color: '#000',
                    size: 16,
                    height: 40
                },
                indicator: {
                    bgColor: '#fff',
                    color: '#696969'
                }
            },
            currentCity: '北京',
            locationWay: 'GPS',
            hotTitle: '热门城市',
            fixedOn: api.frameName,
            placeholder: '输入城市名或首字母查询'
        }, function(ret, err) {
            if(isNotBlack(ret.cityInfo)) {
                city = ret.cityInfo.city;
                showCity(city);
                UICityList.close();
            }
        });
	}
//城市回显
    function showCity(cit){
 	document.getElementById('city_add').innerHTML = cit;
    }
    //打开消息页
    function openMsg(){
        api.execScript({
            name:rootWindowName,
            script:"openTab('msg')"
        })
    }

</script>
</html>